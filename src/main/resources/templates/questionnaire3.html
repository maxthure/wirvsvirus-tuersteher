<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>

    <script th:src="@{/webjars/jquery/jquery.min.js}"
            src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script th:src="@{/webjars/Semantic-UI/semantic.min.js}"
            src="http://cdn.jsdelivr.net/semantic-ui/2.2.10/semantic.min.js"></script>
    <link th:href="@{/webjars/Semantic-UI/semantic.min.css}" rel="stylesheet"
          href="http://cdn.jsdelivr.net/semantic-ui/2.2.10/semantic.min.css" type="text/css"/>

    <script>
        $(document).ready(function () {
            $('.ui.dropdown').dropdown();
            $('#postcode').keyup(function () {
                if ($(this).val().length > 4) {
                    var ort = $('#city');
                    $.getJSON('http://www.geonames.org/postalCodeLookupJSON?&country=' + $('#country').val() + '&callback=?', {postalcode: this.value}, function (response) {
                        if (response && response.postalcodes.length && response.postalcodes[0].placeName) {
                            ort.val(response.postalcodes[0].placeName);
                        }
                    })
                } else {
                    $('#city').val('');
                }
            });
        });
    </script>

    <title th:text="#{questionnaire.title}">!!!ERROR!!!</title>
</head>
<body>
<div class="ui container">
    <header>
        <h1 th:text="#{questionnaire.title}">!!!ERROR!!!</h1>
    </header>

    <nav th:include="navigation :: navigation"></nav>

    <form method="post" role="form" class="ui form" id="form" autocomplete="off" th:action="@{/questionnaire3}"
          th:object="${form}">

        <h2 class="ui dividing header"></h2>

        <div th:each="passenger, itemStat : ${form.visaPassengers}">
            <h3 th:text="#{questionnaire.visa_information}">!!!ERROR!!!</h3>
            <h4 th:text="${passenger.getFirstName()} +' '+ ${passenger.getLastName()}"></h4>

            <input hidden id="firstname" name="firstname" value="" th:value="${passenger.getFirstName()}"/>
            <input hidden id="lastname" name="lastname" th:value="${passenger.getLastName()}"/>
            <input hidden id="date_of_birth" name="lastname" th:value="${passenger.getBirthday()}"/>
            <input hidden id="pass_nr" name="pass_nr" th:value="${passenger.getPassNumber()}"/>
            <input hidden id="pass_expiry_date" name="pass_expiry_date"
                   th:value="${passenger.getPassExpirationDate()}"/>
            <input hidden id="street" name="street" th:value="${passenger.getStreetAndNr()}"/>
            <input hidden id="postcode" name="postcode" value="" th:value="${passenger.getAreaCode()}"/>
            <input hidden id="city" name="city" value="" th:value="${passenger.getCity()}"/>
            <input hidden id="country" name="country" value="de" th:value="${passenger.getCountry()}">
            <input hidden id="email" name="email" th:value="${passenger.getEmail()}"/>
            <input hidden id="mobile" name="email" th:value="${passenger.getMobileNumber()}"/>

            <div class="required field">
                <label for="visaNumber" th:text="#{questionnaire.visaNumber}">!!!ERROR!!!</label>
                <input id="visaNumber" name="email" th:field="*{visaPassengers[__${itemStat.index}__].visaNumber}"
                       th:errorclass="fieldError" type="text"/><br/>
                <div class="ui negative message"
                     th:if="${#fields.hasErrors('visaPassengers[__${itemStat.index}__].visaNumber')}"
                     th:errors="*{visaPassengers[__${itemStat.index}__].visaNumber}">
                    <p>!!!ERROR!!!</p>
                </div>
            </div>
            <div class="required field">
                <label for="visaExpirationDate" th:text="#{questionnaire.visaExpDate}">!!!ERROR!!!</label>
                <input id="visaExpirationDate" name="email"
                       th:field="*{visaPassengers[__${itemStat.index}__].visaExpirationDate}" th:errorclass="fieldError"
                       type="text"/><br/>
                <div class="ui negative message"
                     th:if="${#fields.hasErrors('visaPassengers[__${itemStat.index}__].visaExpirationDate')}"
                     th:errors="*{visaPassengers[__${itemStat.index}__].visaExpirationDate}">
                    <p>!!!ERROR!!!</p>
                </div>
            </div>
            <p></p>
        </div>

        <button type="submit" class="ui button" th:text="#{questionnaire.send}">!!!ERROR!!!</button>
    </form>
</div>
</body>
</html>